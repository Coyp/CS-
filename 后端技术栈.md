# 后端技术栈

## 负载均衡

- 负载均衡算法
  - 轮询/加权轮询
  - 最小连接/加权最小连接
  - 原地址哈希
- 过程
  - 第一级使用DNS（地理位置域名解析）进行分发
  - 后续部署反向代理
- Nginx
  - 负载均衡：
  - 反向代理：若反向代理缓存着用户请求的资源，则直接返回给用户

## 数据存储

- 关系数据库：MySql
  - 主从部署/读写分离
- 数据库访问中间件：提供分表等操作

## 交互 RPC - 远程调用（一个服务器调用另一台服务器，达到本地调用目的）

### 构造

发现&注册中心 + Client + server

## 缓存

### 分类

- 反向代理
- 本地缓存
- 数据库缓存：缓解 DB 查询压力
- 分布式缓存 Redis/ Memcache

### 淘汰策略

- FIFO：类似队列
- LRU：最近最久未使用，保证热点数据
- LRF：最不常使用

### 数据分布

- 哈希分布
  - 一致性哈希：解决节点变动后大量数据rehash迁移问题，只对前一个节点有影响

### 缓存问题

- 缓存穿透
  - 对不存在的数据进行请求，会穿透缓存到达数据库
  - 解决：不存在的缓存存一个空数据/ 过滤请求
- 缓存雪崩
  - 缓存失效（宕机等），导致大量请求到达数据库，进而数据库崩溃
  - 解决：
    - 防止同一时间大面积过期导致的缓存雪崩，合理设置缓存过期时间
    - 防止宕机，设置分布式缓存
    - 缓存预热，防止刚启动不久，还未将大量数据进行缓存而导致缓存雪崩
- 缓存无底洞现象（缓存增加，性能下降）
  - 原因：缓存数目增多，键值分布在更多节点上，导致一次操作涉及多次网络操作
  - 优化批量操作/ 减少网络通信次数

## 消息队列

### 应用

- RocketMQ
- Kafka 高吞吐量，毫秒级延迟，但可能消息重复消费
